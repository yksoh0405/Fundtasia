@model MerchandiseInsertVM

@{
    ViewBag.Title = "Add Merchandise";
}

<!DOCTYPE html>
<link href="~/Content/createMerch.css" rel="stylesheet" />

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Create Merchandise</title>
</head>
<body>

    <form action="" method="post" enctype="multipart/form-data">
        @Html.ValidationSummary(true)

        <div class="form-group">
            <label>Name:</label>

            @Html.TextBoxFor(m => m.Name, new { maxlength = "50", @class = "form-control", autocomplete = "off" })
            @Html.ValidationMessageFor(m => m.Name, "", new { @class = "error-msg" })
        </div>

        <div class="form-group">
            <label>Price:</label>
            @Html.TextBoxFor(m => m.Price, new { @class = "form-control", autocomplete = "off" })
            @Html.ValidationMessageFor(m => m.Price, "", new { @class = "error-msg" })
        </div>

        <div class="form-group">
            <label>Status:</label>
            <div>
                <label class="w-100">@Html.RadioButtonFor(m => m.Status, "Available") Available </label>
            </div>
            <div>
                <label class="w-100">@Html.RadioButtonFor(m => m.Status, "Unavailable") Unavailable </label>
            </div>
            @Html.ValidationMessageFor(m => m.Status, "", new { @class = "error-msg" })
        </div>

        <br />
        <label>Image:</label>
        <div class="image-insert">
            <div class="image-insert-first">
                <input type="file" name="ImageURL" id="ImageURL" class="image-insert-accept" accept="image/jpeg,image/png" onchange="readURL(this);" required />
                <div class="titlecenter">
                    <h6>Click / Drag to Insert Image</h6>
                </div>
            </div>

            <div class="image-insert-content">
                <img class="image-insert-true" src="#" />
                <div class="image-title-first mt-3">
                    <button type="button" onclick="ResetImage()" class="reset-image">Reset Image</button>
                </div>
            </div>
        </div>

        <br />
        <br />
        <section>
            <button class="edit-btn">Add</button>
            <button type="reset" class="create-btn">Reset</button>
        </section>
    </form>
    <br />
    <br />

</body>
</html>

@section foot {
    <script>
        function readURL(image) {
            if (image.files && image.files[0]) {
                var reader = new FileReader();

                reader.onload = function (e) {
                    $(".image-insert-first").hide();

                    $(".image-insert-true").attr("src", e.target.result);
                    $(".image-insert-content").show();

                    $(".image-title").html(image.files[0].name);
                };

                reader.readAsDataURL(image.files[0]);
            } else {
                removeUpload();
            }
        }

        function ResetImage()
        {
            $(".image-insert-accept").replaceWith($(".image-insert-accept").clone());
            $(".image-insert-content").hide();
            $(".image-insert-first").show();
        }

        $(".image-insert-first").bind("dragover", function ()
        {
            $(".image-insert-first").addClass("image-dropping");
        });

        $(".image-insert-first").bind("dragleave", function ()
        {
            $(".image-insert-first").removeClass("image-dropping");
        });

    </script>



    <script>
        function validatePhoto(f) {
            let reType = /^image\/(jpeg|png)$/i;
            let reName = /^.+\.(jpg|jpeg|png)$/i;

            return f &&
                f.size <= 1 * 1024 * 1024 &&
                reType.test(f.type) &&
                reName.test(f.name);
        }

        let src = null;

        $('.upload input').change(e => {
            let f = e.target.files[0];
            let img = $(e.target).siblings('#uploadPreview')[0];

            if (!src) src = img.src;

            if (validatePhoto(f)) {
                img.src = URL.createObjectURL(f);
            }
            else
            {
                img.src = src;
                e.target.value = '';
            }
            $(e.target).valid();
        });
    </script>
}